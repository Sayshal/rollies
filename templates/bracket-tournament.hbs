<div class='rollies-bracket-tournament-dialog'>
  <div class='tournament-header'>
    <h2>{{localize 'Rollies.PlayerDialog.BracketHeader'}}</h2>
    <p>{{localize 'Rollies.PlayerDialog.Instructions' die=dieType}}</p>
    {{#if isEliminated}}
      <div class='spectator-notice'>
        <i class='fas fa-eye'></i>
        <span>{{localize 'Rollies.PlayerDialog.SpectatorMode'}}</span>
      </div>
    {{/if}}
  </div>

  <div class='bracket-container'>
    {{#each bracket.rounds}}
      <div class='bracket-round round-{{roundNumber}}'>
        <h4 class='round-label'>{{localize 'Rollies.PlayerDialog.Round'}} {{roundLabel}}</h4>
        {{#each matches}}
          <div class='bracket-match{{#if isMyMatch}} my-match{{/if}}{{#if matchComplete}} completed-match{{/if}}'
            data-match-id='{{matchId}}'>

            {{! Combatant 1 }}
            <div class='match-combatant{{#if combatant1.isMe}} is-me{{/if}}{{#if combatant1.isLoser}} is-loser{{/if}}'
              data-combatant-id='{{combatant1.id}}'>
              <img src='{{combatant1.img}}' alt='{{combatant1.name}}' class='match-portrait' />
              <div class='match-info'>
                <span class='match-name'>{{combatant1.name}}</span>
                {{! All possible states - _onRender will show/hide }}
                <span class='match-roll' style='display: none;'></span>
                <button type='button' data-action='roll' class='roll-button-small'
                  style='display: none;'>{{localize 'Rollies.PlayerDialog.Roll'}}</button>
                <span class='waiting-text' style='display: none;'>...</span>
              </div>
            </div>

            {{#if combatant2}}
              <div class='match-vs'>vs</div>

              {{! Combatant 2 }}
              <div class='match-combatant{{#if combatant2.isMe}} is-me{{/if}}{{#if combatant2.isLoser}} is-loser{{/if}}'
                data-combatant-id='{{combatant2.id}}'>
                <img src='{{combatant2.img}}' alt='{{combatant2.name}}' class='match-portrait' />
                <div class='match-info'>
                  <span class='match-name'>{{combatant2.name}}</span>
                  {{! All possible states - _onRender will show/hide }}
                  <span class='match-roll' style='display: none;'></span>
                  <button type='button' data-action='roll' class='roll-button-small'
                    style='display: none;'>{{localize 'Rollies.PlayerDialog.Roll'}}</button>
                  <span class='waiting-text' style='display: none;'>...</span>
                </div>
              </div>
            {{else}}
              <div class='match-pending'>
                <span class='pending-text'>{{localize 'Rollies.PlayerDialog.WaitingForWinner'}}</span>
              </div>
            {{/if}}
          </div>
        {{/each}}
      </div>
    {{/each}}
  </div>

  {{#unless isEliminated}}
    <div class='tournament-footer'>
      <div class='countdown-display'>
        <span class='timeout-label'>{{localize 'Rollies.PlayerDialog.TimeRemaining'}}</span>
        <span class='countdown-timer'>{{timeRemaining}}s</span>
      </div>
    </div>
  {{else}}
    <div class='tournament-footer spectator-footer'>
      <p class='spectator-message'>{{localize 'Rollies.PlayerDialog.SpectatingMessage'}}</p>
    </div>
  {{/unless}}

  <div class='dialog-buttons'>
    <button type='submit' class='close-button secondary-button'>
      {{localize 'Rollies.PlayerDialog.CloseButton'}}
    </button>
  </div>
</div>
